<div class="sp-container">
  <!-- <h2>Simple Sliding Puzzle</h2> -->

  <div
    class="sp-board"
    [class.solved]="isSolved()"
    [ngStyle]="dimensionStyle"
    aria-label="Simple sliding puzzle board"
  >
    <button
      class="sp-tile"
      *ngFor="let tile of tiles; let i = index"
      [class.empty]="tile === 0"
      [disabled]="tile === 0 || !canMove(i) || isSolved() || isPaused()"
      (click)="move(i)"
      [attr.aria-label]="tile === 0 ? 'Empty' : 'Tile ' + tile"
    >
      <span *ngIf="tile !== 0">{{ tile }}</span>
    </button>

    <!-- Solved overlay banner with backdrop inside the board -->
    <div class="sp-overlay" *ngIf="isSolved()" aria-live="polite">
      <div class="sp-overlay-card" role="dialog" aria-modal="true" aria-label="Puzzle solved">
        <h3>üéâ Puzzle Solved!</h3>
        <p>Solved in {{ moveCount }} moves, {{ formatTime(elapsedMs) }}.</p>
        <button (click)="reset()" autofocus>Play Again</button>
      </div>
    </div>

    <div class="sp-overlay" *ngIf="isPaused()" aria-live="polite">
      <div class="sp-overlay-card" role="dialog" aria-modal="true" aria-label="Game paused">
        <h3>‚è∏Ô∏è Game Paused</h3>
        <p>Resume to continue playing.</p>
        <button (click)="toggleStartPauseResume()" autofocus>Resume</button>
      </div>
    </div>
  </div>

  <div class="sp-side">
    <div class="sp-stats">
      <div class="div">
        <span
          >Moves: <strong>{{ moveCount }}</strong></span
        >
      </div>
      <div class="div">
        <span
          >Time: <strong class="mono">{{ formatTime(elapsedMs) }}</strong></span
        >
      </div>
    </div>

    <div class="sp-actions">
      <!-- Toggle One: Shuffle before start, End after start -->
      <button
        (click)="hasStarted ? end() : reset()"
        [disabled]="hasStarted ? isSolved() : false"
      >
        {{ hasStarted ? 'End' : 'Shuffle' }}
      </button>

      <!-- Toggle Two: Start, Pause, Resume -->
      <button
        (click)="toggleStartPauseResume()"
        [disabled]="isSolved()"
      >
        {{ startPauseLabel }}
      </button>
    </div>

    <div class="sp-size">
      <select
        aria-label="Board size"
        [(ngModel)]="size"
        (ngModelChange)="setSize($event)"
        [disabled]="hasStarted"
      >
        <option [value]="3">Board - 3√ó3</option>
        <option [value]="4">Board - 4√ó4</option>
        <option [value]="5">Board - 5√ó5</option>
      </select>
    </div>
  </div>
</div>
